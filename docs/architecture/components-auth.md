# Auth Service

## Общее описание

Auth Service - это микросервис, обеспечивающий аутентификацию пользователей в системе Quark. Сервис реализует JWT-токены, хэширование паролей, ограничение частоты запросов и публикацию событий в шину NATS.

## Функции

- Регистрация новых пользователей
- Аутентификация (вход по логину/паролю)
- Генерация и валидация JWT-токенов
- Ограничение частоты попыток входа (rate limiting)
- Публикация событий в NATS (создание пользователя, успешный/неуспешный вход)

## Интеграция с мониторингом

Auth Service интегрирован с системой мониторинга OpenTelemetry:
- **Traces** → Tempo
- **Metrics** → Mimir/Prometheus
- **Logs** → Loki (в формате JSON)

### Экспортируемые метрики

- `http_request_duration_seconds` - время обработки HTTP запросов
- `auth_login_attempts_total` - общее количество попыток входа
- `auth_login_failures_total` - количество неудачных попыток входа

### Экспортируемые трейсы

- Все HTTP запросы автоматически трассируются
- Операции с базой данных
- Взаимодействие с Redis для rate limiting
- Публикация событий в NATS

## Технологии

- FastAPI (Python 3.11+)
- PostgreSQL (через SQLAlchemy)
- Redis (для rate limiting)
- NATS JetStream (для событий)
- JWT (PyJWT)
- bcrypt (хэширование паролей)
- OpenTelemetry (для мониторинга)